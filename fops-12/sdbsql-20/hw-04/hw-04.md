# Домашнее задание к занятию «SQL. Часть 2»

---

Задание можно выполнить как в любом IDE, так и в командной строке.

## Задание 1
### Задание
Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей, и выведите в результат следующую информацию: 
- фамилия и имя сотрудника из этого магазина;
- город нахождения магазина;
- количество пользователей, закреплённых в этом магазине.

### Ответ
```SQL
mysql> select count(*) as customers_count, concat(st.last_name, ' ', st.first_name) as staff_name, ct.city as store_city from customer cust inner join staff st on st.staff_id = cust.store_id inner join city ct on ct.city_id = cust.store_id group by cust.store_id having count(*)>300;
+-----------------+--------------+------------------------+
| customers_count | staff_name   | store_city             |
+-----------------+--------------+------------------------+
|             326 | Hillyer Mike | A Coruña (La Coruña)   |
+-----------------+--------------+------------------------+
1 row in set (0.00 sec)
```
---

## Задание 2
### Задание
Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

### Ответ
```SQL
mysql> select count(*) from film where length > (select avg(length) from film);
+----------+
| count(*) |
+----------+
|      489 |
+----------+
1 row in set (0.01 sec)
```

## Задание 3
### Задание
Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.

### Ответ
```SQl
mysql> select * from (select sum(amount) as income_per_month, month(payment_date) as month, count(rental_id) as rents_count from payment group by month) as temp order by income_per_month desc limit 1;
+------------------+-------+-------------+
| income_per_month | month | rents_count |
+------------------+-------+-------------+
|         28368.91 |     7 |        6709 |
+------------------+-------+-------------+
1 row in set (0.00 sec)